!function(a){var c=function(b,c){var d=a(b),e=d.attr("length")||0,f=d.attr("id");(null===f||""===f)&&(f="up_"+(new Date).getTime(),d.attr("id",f));var g=d.attr("shower")||"#up_shower_"+f;e=Number(e);var h=a('<button type="button" class="smbox-upfile-btn smbox-upgroup" >\u9009\u62e9\u6587\u4ef6</button>').insertBefore(d),i=a(g);if(i.length>0){var j=function(){return i.find("div.smbox-fileitem").length},k=function(){var b=[];if(i.find("div.smbox-fileitem").each(function(c,d){var e=a(d);b.push(e.data("dat"))}),0===b.length)d.val("");else{var c=a.toJSON(b);d.val(c)}},l=function(b){var c=a('<div class="smbox-fileitem"></div>').data("dat",b);c.mouseenter(function(){a(this).addClass("smbox-file-index")}),c.mouseleave(function(){a(this).removeClass("smbox-file-index")}),c.append("<span>"+b.localname+"</span>");var d=a('<a href="javascript:void(0);">\u5220\u9664</a>').addClass("smbox-delfile").appendTo(c);if(d.click(function(){if(a(this).parent(".smbox-fileitem").remove(),0!==e){var b=j();e>b&&(h[0].disabled=!1),k()}}),i.append(c),0!==e){var f=j();f>=e&&(h[0].disabled=!0)}},m=d.val(),n=[];if(""!==m&&"null"!==m)try{n=a.parseJSON(m)}catch(o){}if(a.isArray(n))for(var p=0;p<n.length;p++)l(n[p]);0!==e&&(c.beginUpfile=function(){var a=j();return a>=e?(alert("\u6700\u5927\u4e0a\u4f20\u6587\u4ef6\u6570\u91cf\u4e3a "+e+" !"),!1):!0}),c.afterUpfile=function(a){if(a&&""===a.err){var b=a.msg;l(b),k()}},c.button=h[0]}c.noSetVal=!0,a(b).initAjaxUpFile(c),this.BoxClose=function(){a(b).initAjaxUpFile("close")}};a.fn.initUpGroup=function(a){this.each(function(){if(this.UpGroup)"string"==typeof a&&"close"===a&&(this.UpGroup.BoxClose(),this.UpGroup=null);else{var b=new c(this,a);this.UpGroup=b}})}}(jQuery);